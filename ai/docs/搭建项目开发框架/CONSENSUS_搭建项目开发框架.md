# CONSENSUS\_搭建项目开发框架

## 明确的需求描述和边界限制

### 核心需求

搭建一个完整的 **加密视频U盘** 项目开发框架，支持：

- Electron + Vue.js 3 + TypeScript 技术栈
- 医疗风格的老年友好界面
- 视频加密播放功能基础架构
- Windows 7/10/11 兼容性
- U盘直接运行能力

### 边界限制

#### 包含范围

1. **项目基础架构**
   - 完整的目录结构设计
   - 依赖管理和版本控制
   - 构建和打包配置
   - 开发环境配置

2. **技术栈集成**
   - Electron 主进程和渲染进程配置
   - Vue.js 3 + TypeScript + Vite 集成
   - Element Plus UI 组件库集成
   - Pinia 状态管理配置
   - Vue Router 路由配置

3. **开发工具链**
   - ESLint + Prettier 代码规范
   - Husky + lint-staged 提交钩子
   - TypeScript 类型检查配置
   - 热重载开发服务器

4. **基础样式系统**
   - 医疗蓝主题色彩系统
   - 老年友好字体和间距
   - Element Plus 组件定制
   - CSS 变量系统

#### 不包含范围

- 具体业务功能实现
- 视频加密解密算法
- 完整的页面开发
- 单元测试和集成测试
- 生产环境部署配置

## 需求实现对应业务流程

### 1. 项目初始化流程

```
创建项目根目录
├── 初始化 package.json
├── 安装核心依赖
├── 配置 TypeScript
├── 配置构建工具
└── 配置开发环境
```

### 2. 架构搭建流程

```
设计目录结构
├── src/
│   ├── main/          # Electron 主进程
│   ├── renderer/      # Vue.js 渲染进程
│   └── shared/        # 共享代码
├── build/             # 构建配置
├── resources/         # 资源文件
└── dist/              # 构建输出
```

### 3. 开发工具配置流程

```
代码质量控制
├── ESLint 规则配置
├── Prettier 格式化配置
├── Husky Git 钩子配置
├── TypeScript 类型检查
└── VS Code 工作区配置
```

### 4. UI 系统集成流程

```
Element Plus 定制
├── 主题色彩配置
├── 组件样式覆盖
├── 老年友好适配
├── 医疗风格定制
└── 响应式布局配置
```

## 业务流程背后的逻辑和规则约束

### 1. 架构设计原则

#### 分层架构

- **主进程层**: 负责应用生命周期、窗口管理、文件操作
- **渲染进程层**: 负责用户界面、用户交互、视频播放
- **共享层**: 负责类型定义、工具函数、通信协议

#### 模块化原则

- 高内聚：每个模块职责单一明确
- 低耦合：模块间依赖关系清晰简单
- 可扩展：支持功能模块的增加和修改

### 2. 技术选型约束

#### 版本兼容性

- Node.js: >= 16.0.0 (Electron 要求)
- Electron: ^25.0.0 (稳定版本)
- Vue.js: ^3.3.0 (Composition API)
- TypeScript: ^5.0.0 (最新特性支持)

#### 依赖管理规则

- 主要依赖版本锁定
- 开发依赖使用 `^` 范围版本
- 定期更新并测试兼容性
- 避免引入过多小型依赖

### 3. 代码规范约束

#### 命名规范

- 文件名：kebab-case (短横线命名)
- 组件名：PascalCase (大驼峰)
- 变量名：camelCase (小驼峰)
- 常量名：UPPER_SNAKE_CASE (大写下划线)

#### 目录结构规范

```
src/
├── main/
│   ├── index.ts           # 主进程入口
│   ├── window-manager.ts  # 窗口管理
│   ├── security.ts        # 安全配置
│   └── utils/             # 主进程工具
├── renderer/
│   ├── main.ts            # 渲染进程入口
│   ├── App.vue            # 根组件
│   ├── components/        # 通用组件
│   ├── views/             # 页面组件
│   ├── stores/            # Pinia 状态
│   ├── router/            # 路由配置
│   ├── styles/            # 样式文件
│   └── utils/             # 渲染进程工具
└── shared/
    ├── types/             # TypeScript 类型
    ├── constants/         # 常量定义
    ├── utils/             # 共享工具
    └── ipc/               # IPC 通信协议
```

### 4. 安全配置约束

#### Electron 安全最佳实践

- 启用上下文隔离 (contextIsolation: true)
- 禁用 Node.js 集成 (nodeIntegration: false)
- 启用沙箱模式 (sandbox: true)
- 配置内容安全策略 (CSP)
- 限制导航和新窗口创建

#### 开发环境安全

- 开发服务器仅监听本地地址
- 生产构建移除开发工具
- 敏感信息使用环境变量

## 验收标准

### 1. 项目结构验收

- [ ] 目录结构符合三层架构设计
- [ ] package.json 包含所有必要依赖
- [ ] TypeScript 配置正确且无类型错误
- [ ] 构建配置支持开发和生产环境

### 2. 开发环境验收

- [ ] `npm run dev` 能正常启动开发服务器
- [ ] 主进程和渲染进程热重载正常工作
- [ ] ESLint 和 Prettier 规则正确应用
- [ ] Git 提交钩子正常工作

### 3. 技术栈集成验收

- [ ] Electron 应用能正常启动和关闭
- [ ] Vue.js 组件能正常渲染
- [ ] Element Plus 组件能正常使用
- [ ] Pinia 状态管理正常工作
- [ ] Vue Router 路由跳转正常

### 4. UI 系统验收

- [ ] 医疗蓝主题色彩正确应用
- [ ] 字体大小符合老年友好标准
- [ ] Element Plus 组件样式定制生效
- [ ] 响应式布局在不同分辨率下正常

### 5. 构建打包验收

- [ ] `npm run build` 能成功构建
- [ ] 构建产物能在目标 Windows 版本运行
- [ ] 应用体积在合理范围内
- [ ] 启动速度满足用户体验要求

### 6. 代码质量验收

- [ ] 所有 TypeScript 类型检查通过
- [ ] ESLint 检查无错误和警告
- [ ] 代码格式符合 Prettier 规范
- [ ] 关键模块有适当的注释说明

### 7. 兼容性验收

- [ ] Windows 7 系统兼容性测试通过
- [ ] Windows 10 系统兼容性测试通过
- [ ] Windows 11 系统兼容性测试通过
- [ ] 不同屏幕分辨率适配正常

## 实施计划

### 第一阶段：基础框架搭建

1. 创建项目目录结构
2. 初始化 package.json 和依赖安装
3. 配置 TypeScript 和构建工具
4. 配置代码质量工具

### 第二阶段：技术栈集成

1. 配置 Electron 主进程和渲染进程
2. 集成 Vue.js 3 和相关生态
3. 配置 Element Plus 和主题定制
4. 实现基础的 IPC 通信

### 第三阶段：开发环境优化

1. 配置热重载和开发服务器
2. 优化构建性能
3. 完善开发工具配置
4. 编写开发文档

### 第四阶段：验收测试

1. 执行所有验收标准检查
2. 在不同 Windows 版本测试
3. 性能和兼容性验证
4. 文档完善和交付
